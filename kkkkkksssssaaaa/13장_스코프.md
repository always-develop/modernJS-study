# 13장. 스코프

# [javascript] ☕ 모던 자바스크립트

---

## 13장. 스코프

### 13.1 스코프란?

- 스코프란… 식별자가 유효한 범위를 뜻함
    - 즉.. 식별자가 참조될 수 있는 범위
    - 스코프라는 개념이 없다면 프로그램 당 식별자를 고유하게 작성해야 하는 대참사가 일어날 수 있음
- 코드가 어디서 실행되며 주변에 어떤 코드가 있는지.. 를 `렉시컬 환경` 이라고 부른다
    - 렉시컬 환경을 구현한 것이 실행 컨텍스트라고 한다
- 스코프는 마치 컴퓨터 폴더/파일과 같다
    - 같은 폴더 내에서 동일한 이름의 파일은 존재할 수 없음
    - 즉, 파일은 폴더 내에서 유일한 이름이어야함
    - 단, 다른 폴더에 동일한 이름을 가진 파일은 존재할 수 있음

### 13.2 스코프의 종류

- 전역 스코프(global scope)
    - 보통 .js 파일의 최상위에 선언하면 전역 스코프에 해당함
- 지역 스코프(local scope)
    - 함수 내에서 선언된 식별자는 지역 스코프에 해당
- 하위 스코프는 상위 스코프에 접근할 수 있으나, 상위 스코프는 하위 스코프에 접근할 수 있음

```jsx
var a = 0;

(function() {
	console.log(a); // 0;
  var b = 1;
}());

console.log(b); // ReferenceError
```

### 13.3 스코프 체인

- 자바스크립트의 함수는 중첩 가능하며, 스코프도 함수의 중첩에 따라 계층적인 구조를 갖게 됨
- 계층적으로 연결된 스코프를 `스코프 체인` 이라고 함
- 스코프 체인 구조에서도 전역-지역 변수의 특징과 마찬가지로 하위 스코프는 상위 스코프에 접근할 수 있으나, 상위 스코프는 하위 스코프에 접근할 수 없음

```jsx
(function() {
  var b = 1;
  
  (function() {
    console.log(b); // 1
    var c = 2;
  } ());

  console.log(c); // ReferenceError
} ());
```

- 위와 같은 특성 때문에 스코프 체인은 마치 상속과 비슷한 특징을 지니게 됨
- 스코프는 딱히 변수에 해당하는 개념은 아니다
    - 식별자에 대한 검색 규칙이라고 하는게 더 적합

### 13.4 함수 레벨 스코프

- var 는 블록 레벨 스코프를 인정하지 않고 오로지 함수 레벨의 스코프만 인정한다
    - if, while 등 제어문 내에서 선언된 식별자의 스코프를 무시한다 😱
    - let, const 는 블록 레벨 스코프가 적용된다
- var 는 절대 쓰지 말아야겠다…………….

### 13.5 렉시컬 스코프

- 함수를 어디서 호출했는지에 따라 함수위 상위 스코프를 결정하는 것을 `동적 스코프(dynamic scope)` 라고 한다
- 함수를 어디서 정의했는지에 따라 함수의 상위 스코프를 결정하는 것을 `정적 스코프(static scope)` 혹은 `렉시컬 스코프(lexical scope)` 라고 한다
- 다행히 자바스크립트를 포함한 거의 대부분의 언어들이 렉시컬 스코프를 따른다고 한다

```jsx
var x = 1;

function foo() {
  var x = 10;
  bar();
}

function bar() {
  console.log(x);
}

foo(); // 1
bar(); // 1
```

- 위와 같은 코드에서는 foo() 가 호출되는 시점에서 bar() 의 상위 스코프가 foo() 가 되는 것 같으나, 사실은 bar() 의 상위 스코프는 전역 스코프가 된다
    - 그렇기 때문에 foo() 안에서 호출한 bar() 가 참조한 x 는 foo() 의 x 가 아니게 된다
    - 당연히 bar() 가 foo() 내부에서 **정의** 되었다면 얘기는 달라진다